{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
  <h2 class="text-center mb-4">üí™ Rutinas de Entrenamiento</h2>
  <p class="text-center">Selecciona un entorno y descubre rutinas dise√±adas para ese espacio.</p>

  <!-- TARJETAS DE CATEGOR√çAS -->
  <div class="row mt-4" id="contenedor-tarjetas">
    <!-- RUTINAS EN CASA -->
    <div class="col-md-4 mb-4">
      <div class="card p-3 shadow-sm h-100 categoria-card">
        <h5>üè† Rutinas en Casa</h5>
        <p>Entrena desde la comodidad de tu hogar con poco o ning√∫n equipo.</p>
        <button class="btn btn-primary w-100" type="button" onclick="toggleSection('casa')">Ver Rutinas</button>
        <div id="casa" class="rutina-section mt-3 collapse">
          <ul class="list-group">
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Rutina Full Body (sin pesas)', this)">Rutina Full Body (sin pesas)</li>
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Cardio 20 min en casa', this)">Cardio 20 min en casa</li>
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Yoga y estiramientos matutinos', this)">Yoga y estiramientos matutinos</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- RUTINAS LABORALES -->
    <div class="col-md-4 mb-4">
      <div class="card p-3 shadow-sm h-100 categoria-card">
        <h5>üíº Rutinas Laborales</h5>
        <p>Ejercicios cortos para realizar durante tu jornada laboral.</p>
        <button class="btn btn-primary w-100" type="button" onclick="toggleSection('laboral')">Ver Rutinas</button>
        <div id="laboral" class="rutina-section mt-3 collapse">
          <ul class="list-group">
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Ejercicios de estiramiento en oficina', this)">Ejercicios de estiramiento en oficina</li>
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Pausas activas de 10 minutos', this)">Pausas activas de 10 minutos</li>
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Movilidad cervical y lumbar', this)">Movilidad cervical y lumbar</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- RUTINAS AL AIRE LIBRE -->
    <div class="col-md-4 mb-4">
      <div class="card p-3 shadow-sm h-100 categoria-card">
        <h5>üå≥ Rutinas al Aire Libre</h5>
        <p>Aprovecha el espacio exterior para entrenar y conectar con la naturaleza.</p>
        <button class="btn btn-primary w-100" type="button" onclick="toggleSection('airelibre')">Ver Rutinas</button>
        <div id="airelibre" class="rutina-section mt-3 collapse">
          <ul class="list-group">
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Caminata + trote ligero', this)">Caminata + trote ligero</li>
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Circuito de ejercicios en parque', this)">Circuito de ejercicios en parque</li>
            <li class="list-group-item rutina-item" onclick="mostrarRutinaDetallada('Entrenamiento con peso corporal', this)">Entrenamiento con peso corporal</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- SECCI√ìN DETALLADA -->
  <div id="detalle-rutina" class="mt-5 p-4 rounded shadow-sm bg-light d-none animate__animated animate__fadeIn">
    <h3 id="titulo-rutina" class="text-center mb-3"></h3>
    <p id="descripcion-rutina" class="text-center"></p>
    <hr>
    <ol id="pasos-rutina" class="list-group list-group-numbered"></ol>
  </div>
</div>

<!-- ESTILOS -->
<style>
.rutina-item {
  cursor: pointer;
  transition: 0.3s;
}
.rutina-item:hover {
  background-color: #0d6efd;
  color: white;
  transform: scale(1.03);
}
.rutina-item.activa {
  background-color: #0d6efd;
  color: white;
  font-weight: bold;
}
.categoria-card.inactiva {
  opacity: 0.4;
  pointer-events: none;
  transition: 0.5s ease;
}
</style>

<!-- SCRIPT -->
<script>
function toggleSection(id) {
  const section = document.getElementById(id);
  document.querySelectorAll('.rutina-section').forEach(sec => {
    if (sec !== section) sec.classList.remove('show');
  });
  section.classList.toggle('show');
}

function mostrarRutinaDetallada(nombre, elemento) {
  const detalle = document.getElementById('detalle-rutina');
  const titulo = document.getElementById('titulo-rutina');
  const descripcion = document.getElementById('descripcion-rutina');
  const pasos = document.getElementById('pasos-rutina');

  // Marcar la rutina activa
  document.querySelectorAll('.rutina-item').forEach(i => i.classList.remove('activa'));
  elemento.classList.add('activa');

  // Inactivar las dem√°s categor√≠as
  document.querySelectorAll('.categoria-card').forEach(card => card.classList.add('inactiva'));
  elemento.closest('.categoria-card').classList.remove('inactiva');

  // Mostrar solo el detalle
  detalle.classList.remove('d-none');
  detalle.scrollIntoView({ behavior: "smooth" });

  // Mismo objeto de rutinas (no se modifica)
  const rutinas = { ...{{rutinas|safe}} }; // Ignorado en HTML puro, usar tu objeto original aqu√≠

  // Simulaci√≥n de ejemplo si est√°s en HTML puro:
  const rutinasEjemplo = {
    "Cardio 20 min en casa": {
      descripcion: "Rutina r√°pida para mejorar resistencia cardiovascular y quemar calor√≠as desde casa.",
      detalles: ["‚è±Ô∏è Duraci√≥n: 20 min", "üî• Intensidad: moderada a alta", "üéØ Objetivo: resistencia y quema de grasa"],
      pasos: ["5 min calentamiento", "Circuito de 3 rondas", "Respiraci√≥n final"]
    }
  };

  const rutina = rutinasEjemplo[nombre] || { descripcion: "", detalles: [], pasos: [] };
  titulo.textContent = nombre;
  descripcion.innerHTML = `
    <p>${rutina.descripcion}</p>
    <ul class="list-unstyled text-start mx-auto" style="max-width:600px;">
      ${rutina.detalles.map(d => `<li>${d}</li>`).join("")}
    </ul>
  `;
  pasos.innerHTML = rutina.pasos.map(p => `<li class="list-group-item">${p}</li>`).join("");
}
</script>
{% endblock %}
