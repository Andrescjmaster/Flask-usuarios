{% extends "base.html" %}

{% block title %}Inicio - Mi ADN{% endblock %}

{% block content %}
<div class="home-container">

    <section id="hero" class="left-align" data-image-url="{{ url_for('static', filename='img/fondo1.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h1>TRANSFORMA TU CÓDIGO</h1>
            <h4>ACTITUD DISCIPLINA NEOVITAL</h4>
            <p class="subtitle-hero">Te damos la mentalidad, el entrenamiento y la guia para construir el fisico y la disciplina que siempre has querido</p>
        </div>
    </section>

    <section id="info" class="info right-align" data-image-url="{{ url_for('static', filename='img/fondo2.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>¿QUÉ ES ADN?</h2>
            <p>ADN Fitness combina tecnología, biología y salud para ofrecerte un enfoque único hacia tu bienestar.</p>
        </div>
    </section>

    <section id="features" class="features center-align" data-image-url="{{ url_for('static', filename='img/fondo3.png') }}">
        <div class="overlay-dark"></div>
        <div class="content">
            <h2>EXPLORA TU ADN</h2>
            <p>Conoce más sobre tu cuerpo, tus hábitos y tus posibilidades a través de nuestras herramientas interactivas.</p>
        </div>

        <div class="cards">
            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura1.png') }}');">
                <div class="card-hover">
                    <h3>Estructura Corporal</h3>
                    <p>Analiza tu composición física y optimiza tu rendimiento.</p>
                </div>
            </div>

            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura2.png') }}');">
                <div class="card-hover">
                    <h3>Estructura Nutricional</h3>
                    <p>Adapta tu alimentación según tus necesidades genéticas.</p>
                </div>
            </div>

            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura3.png') }}');">
                <div class="card-hover">
                    <h3>Calculadora de Estado</h3>
                    <p>Descubre tu IMC y analiza tu estado físico en segundos.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="about" class="about center-align" data-image-url="{{ url_for('static', filename='img/fondo4.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>¿QUIÉNES SOMOS?</h2>
            <p>Somos tu plataforma de fitness que elimina las conjeturas. Nuestra mision es                  la personalización absoluta:</p>
            <p>DIAGNOSTICO CERTERO: usamos nuestra calculadora de estado físico para un   análisis preciso de tu condición.</p>
            <p>PLANES A TU MEDIDA: Diseñamos rutinas de ejercicios y nutricion creados solo para ti, basados en tus datos y metas.</p>
            <p>RESULTADOS REALES: Te damos el mapa de ruta exacto que necesitas para transformar tu cuerpo y alcanzar tu maximo potencial.</p>
        </div>
    </section>

<section id="contact" class="contact left-align">
        <div class="overlay"></div>
        <div class="content">
            <h2>CONTÁCTANOS</h2>
            <div class="socials">
                <a href="https://www.instagram.com/ADN_1325" target="_blank"><i class="fab fa-instagram me-2"></i>@ADN_1325</a>
                <a href="https://www.facebook.com/ADN_1325" target="_blank"><i class="fab fa-facebook me-2"></i>@ADN_1325</a>
                <p><i class="fas fa-phone-alt me-2"></i>+57 321 4319033</p>
                <p><i class="fas fa-phone-alt me-2"></i>+57 322 8766062</p>
                <p><i class="fas fa-envelope me-2"></i>ADN1325@gmail.com</p>
            </div>
        </div>
    </section>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const sections = document.querySelectorAll('.home-container section');
        const body = document.body;

        // Carga la primera imagen al inicio
        const initialImage = sections[0].getAttribute('data-image-url');
        if (initialImage) {
            body.style.backgroundImage = `url('${initialImage}')`;
            body.classList.add('smooth-scroll-animation'); // Inicia la animación en el body
        }
        
        // Función para cambiar el fondo
        let lastSectionUrl = initialImage;

        const updateBackground = () => {
            let currentSection = sections[0];
            let closestDistance = Infinity;
            const windowCenter = window.innerHeight / 2;

            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                // Distancia vertical desde el centro de la sección hasta el centro de la ventana
                const sectionCenter = rect.top + rect.height / 2;
                const distance = Math.abs(sectionCenter - windowCenter);

                if (distance < closestDistance) {
                    closestDistance = distance;
                    currentSection = section;
                }
            });

            const newImageUrl = currentSection.getAttribute('data-image-url');

            // Solo actualiza si la URL de la imagen ha cambiado para evitar re-renderizados
            if (newImageUrl && newImageUrl !== lastSectionUrl) {
                // Previene la repetición del cambio rápido de fondo
                if (!body.classList.contains('is-transitioning')) {
                    body.classList.add('is-transitioning');
                    
                    // Aplicar una transición de fondo suave (si lo quieres)
                    body.style.transition = 'background-image 0.5s ease-in-out';
                    
                    // Cambia la imagen
                    body.style.backgroundImage = `url('${newImageUrl}')`;
                    
                    // Retrasa la remoción de la clase para permitir la transición
                    setTimeout(() => {
                        body.classList.remove('is-transitioning');
                        body.style.transition = 'none'; // Vuelve a none
                    }, 500); // 500ms = duración de la transición

                    lastSectionUrl = newImageUrl;
                }
            }
        };

        // Usa Intersection Observer para mayor eficiencia (mejor que solo scroll)
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            // El threshold de 0.5 significa que se dispara cuando el 50% de la sección es visible
            threshold: 0.5 
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Llamar a la lógica de actualización cuando la sección está en el viewport
                    updateBackground();
                }
            });
        }, observerOptions);

        sections.forEach(section => observer.observe(section));

        // Fallback: Si el Intersection Observer no funciona perfecto con scroll-snap, 
        // puedes usar el evento scroll, pero es más pesado.
        // window.addEventListener('scroll', updateBackground);

    });
</script>
{% endblock %}