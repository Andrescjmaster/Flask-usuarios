{% extends "base.html" %}

{% block title %}Inicio - Mi ADN{% endblock %}

{% block content %}
<div class="home-container">

    <section id="hero" class="left-align" data-image-url="{{ url_for('static', filename='img/fondo1.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h1>TRANSFORMA TU CDIGO</h1>
            <h4>ACTITUD DISCIPLINA NEOVITAL</h4>
            <p class="subtitle-hero">Te damos la mentalidad, el entrenamiento y la guia para construir el fisico y la disciplina que siempre has querido</p>
        </div>
    </section>

    <section id="info" class="info right-align" data-image-url="{{ url_for('static', filename='img/fondo2.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>驴QU ES ADN?</h2>
            <p>ADN Fitness combina tecnolog铆a, biolog铆a y salud para ofrecerte un enfoque 煤nico hacia tu bienestar.</p>
        </div>
    </section>

    <section id="features" class="features center-align" data-image-url="{{ url_for('static', filename='img/fondo3.png') }}">
        <div class="overlay-dark"></div>
        <div class="content">
            <h2>EXPLORA TU ADN</h2>
            <p>Conoce m谩s sobre tu cuerpo, tus h谩bitos y tus posibilidades a trav茅s de nuestras herramientas interactivas.</p>
        </div>

        <div class="cards">
            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura1.png') }}');">
                <div class="card-hover">
                    <h3>Estructura Corporal</h3>
                    <p>Analiza tu composici贸n f铆sica y optimiza tu rendimiento.</p>
                </div>
            </div>

            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura2.png') }}');">
                <div class="card-hover">
                    <h3>Estructura Nutricional</h3>
                    <p>Adapta tu alimentaci贸n seg煤n tus necesidades gen茅ticas.</p>
                </div>
            </div>

            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura3.png') }}');">
                <div class="card-hover">
                    <h3>Calculadora de Estado</h3>
                    <p>Descubre tu IMC y analiza tu estado f铆sico en segundos.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="about" class="about center-align" data-image-url="{{ url_for('static', filename='img/fondo4.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>驴QUINES SOMOS?</h2>
            <p>Somos tu plataforma de fitness que elimina las conjeturas. Nuestra mision es                  la personalizaci贸n absoluta:</p>
            <p>DIAGNOSTICO CERTERO: usamos nuestra calculadora de estado f铆sico para un   an谩lisis preciso de tu condici贸n.</p>
            <p>PLANES A TU MEDIDA: Dise帽amos rutinas de ejercicios y nutricion creados solo para ti, basados en tus datos y metas.</p>
            <p>RESULTADOS REALES: Te damos el mapa de ruta exacto que necesitas para transformar tu cuerpo y alcanzar tu maximo potencial.</p>
        </div>
    </section>

    <section id="contact" class="contact left-align" data-image-url="{{ url_for('static', filename='img/fondo5.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>CONTCTANOS</h2>
            <div class="socials">
                <a href="#"><i class="fab fa-instagram">@ADN_1325</i></a>
                <a href="#"><i class="fab fa-facebook"></i>@ADN_1325</a>
                <p> +57 321 4319033</p>
                <p> +57 322 8766062</p>
                <p> ADN1325@gmail.com</p>
            </div>
        </div>
    </section>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const sections = document.querySelectorAll('.home-container section');
        const body = document.body;

        // Carga la primera imagen al inicio
        const initialImage = sections[0].getAttribute('data-image-url');
        if (initialImage) {
            body.style.backgroundImage = `url('${initialImage}')`;
            body.classList.add('smooth-scroll-animation'); // Inicia la animaci贸n en el body
        }
        
        // Funci贸n para cambiar el fondo
        let lastSectionUrl = initialImage;

        const updateBackground = () => {
            let currentSection = sections[0];
            let closestDistance = Infinity;
            const windowCenter = window.innerHeight / 2;

            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                // Distancia vertical desde el centro de la secci贸n hasta el centro de la ventana
                const sectionCenter = rect.top + rect.height / 2;
                const distance = Math.abs(sectionCenter - windowCenter);

                if (distance < closestDistance) {
                    closestDistance = distance;
                    currentSection = section;
                }
            });

            const newImageUrl = currentSection.getAttribute('data-image-url');

            // Solo actualiza si la URL de la imagen ha cambiado para evitar re-renderizados
            if (newImageUrl && newImageUrl !== lastSectionUrl) {
                // Previene la repetici贸n del cambio r谩pido de fondo
                if (!body.classList.contains('is-transitioning')) {
                    body.classList.add('is-transitioning');
                    
                    // Aplicar una transici贸n de fondo suave (si lo quieres)
                    body.style.transition = 'background-image 0.5s ease-in-out';
                    
                    // Cambia la imagen
                    body.style.backgroundImage = `url('${newImageUrl}')`;
                    
                    // Retrasa la remoci贸n de la clase para permitir la transici贸n
                    setTimeout(() => {
                        body.classList.remove('is-transitioning');
                        body.style.transition = 'none'; // Vuelve a none
                    }, 500); // 500ms = duraci贸n de la transici贸n

                    lastSectionUrl = newImageUrl;
                }
            }
        };

        // Usa Intersection Observer para mayor eficiencia (mejor que solo scroll)
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            // El threshold de 0.5 significa que se dispara cuando el 50% de la secci贸n es visible
            threshold: 0.5 
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Llamar a la l贸gica de actualizaci贸n cuando la secci贸n est谩 en el viewport
                    updateBackground();
                }
            });
        }, observerOptions);

        sections.forEach(section => observer.observe(section));

        // Fallback: Si el Intersection Observer no funciona perfecto con scroll-snap, 
        // puedes usar el evento scroll, pero es m谩s pesado.
        // window.addEventListener('scroll', updateBackground);

    });
</script>
{% endblock %}