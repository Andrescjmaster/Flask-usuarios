{% extends "base.html" %}

{% block title %}Inicio - Mi ADN{% endblock %}

{% block content %}
<div class="home-container">

    <section id="hero" class="left-align" data-image-url="{{ url_for('static', filename='img/fondo1.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h1>TRANSFORMA TU C칍DIGO</h1>
            <h4>ACTITUD DISCIPLINA NEOVITAL</h4>
            <p class="subtitle-hero">Te damos la mentalidad, el entrenamiento y la guia para construir el fisico y la disciplina que siempre has querido</p>
        </div>
    </section>

    <section id="info" class="info right-align" data-image-url="{{ url_for('static', filename='img/fondo2.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>쯈U칄 ES ADN?</h2>
            <p>ADN Fitness combina tecnolog칤a, biolog칤a y salud para ofrecerte un enfoque 칰nico hacia tu bienestar.</p>
        </div>
    </section>

    <section id="features" class="features center-align" data-image-url="{{ url_for('static', filename='img/fondo3.png') }}">
        <div class="overlay-dark"></div>
        <div class="content">
            <h2>EXPLORA TU ADN</h2>
            <p>Conoce m치s sobre tu cuerpo, tus h치bitos y tus posibilidades a trav칠s de nuestras herramientas interactivas.</p>
        </div>

        <div class="cards">
            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura1.png') }}');">
                <div class="card-hover">
                    <h3>Estructura Corporal</h3>
                    <p>Analiza tu composici칩n f칤sica y optimiza tu rendimiento.</p>
                </div>
            </div>

            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura2.png') }}');">
                <div class="card-hover">
                    <h3>Estructura Nutricional</h3>
                    <p>Adapta tu alimentaci칩n seg칰n tus necesidades gen칠ticas.</p>
                </div>
            </div>

            <div class="card" style="background-image: url('{{ url_for('static', filename='img/estructura3.png') }}');">
                <div class="card-hover">
                    <h3>Calculadora de Estado</h3>
                    <p>Descubre tu IMC y analiza tu estado f칤sico en segundos.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="about" class="about center-align" data-image-url="{{ url_for('static', filename='img/fondo4.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>쯈UI칄NES SOMOS?</h2>
            <p>Somos un equipo apasionado por la salud, el deporte y la ciencia. Buscamos mejorar tu calidad de vida a trav칠s del conocimiento y la tecnolog칤a.</p>
        </div>
    </section>

    <section id="contact" class="contact left-align" data-image-url="{{ url_for('static', filename='img/fondo5.png') }}">
        <div class="overlay"></div>
        <div class="content">
            <h2>CONT츼CTANOS</h2>
            <div class="socials">
                <a href="#"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-facebook"></i></a>
                <p>游 +57 300 000 0000</p>
                <p>游닎 miadnfitness@gmail.com</p>
            </div>
        </div>
    </section>

    <footer>
        <p>춸 2025 Mi ADN Fitness - Todos los derechos reservados</p> 
    </footer>

</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const sections = document.querySelectorAll('.home-container section');
        const body = document.body;

        // Carga la primera imagen al inicio
        const initialImage = sections[0].getAttribute('data-image-url');
        if (initialImage) {
            body.style.backgroundImage = `url('${initialImage}')`;
            body.classList.add('smooth-scroll-animation'); // Inicia la animaci칩n en el body
        }
        
        // Funci칩n para cambiar el fondo
        let lastSectionUrl = initialImage;

        const updateBackground = () => {
            let currentSection = sections[0];
            let closestDistance = Infinity;
            const windowCenter = window.innerHeight / 2;

            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                // Distancia vertical desde el centro de la secci칩n hasta el centro de la ventana
                const sectionCenter = rect.top + rect.height / 2;
                const distance = Math.abs(sectionCenter - windowCenter);

                if (distance < closestDistance) {
                    closestDistance = distance;
                    currentSection = section;
                }
            });

            const newImageUrl = currentSection.getAttribute('data-image-url');

            // Solo actualiza si la URL de la imagen ha cambiado para evitar re-renderizados
            if (newImageUrl && newImageUrl !== lastSectionUrl) {
                // Previene la repetici칩n del cambio r치pido de fondo
                if (!body.classList.contains('is-transitioning')) {
                    body.classList.add('is-transitioning');
                    
                    // Aplicar una transici칩n de fondo suave (si lo quieres)
                    body.style.transition = 'background-image 0.5s ease-in-out';
                    
                    // Cambia la imagen
                    body.style.backgroundImage = `url('${newImageUrl}')`;
                    
                    // Retrasa la remoci칩n de la clase para permitir la transici칩n
                    setTimeout(() => {
                        body.classList.remove('is-transitioning');
                        body.style.transition = 'none'; // Vuelve a none
                    }, 500); // 500ms = duraci칩n de la transici칩n

                    lastSectionUrl = newImageUrl;
                }
            }
        };

        // Usa Intersection Observer para mayor eficiencia (mejor que solo scroll)
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            // El threshold de 0.5 significa que se dispara cuando el 50% de la secci칩n es visible
            threshold: 0.5 
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Llamar a la l칩gica de actualizaci칩n cuando la secci칩n est치 en el viewport
                    updateBackground();
                }
            });
        }, observerOptions);

        sections.forEach(section => observer.observe(section));

        // Fallback: Si el Intersection Observer no funciona perfecto con scroll-snap, 
        // puedes usar el evento scroll, pero es m치s pesado.
        // window.addEventListener('scroll', updateBackground);

    });
</script>
{% endblock %}